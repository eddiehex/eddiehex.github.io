<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shark Blog</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/prism-code.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="icon" href="https://hexo.kygoho.win/upload/uploads/6e7cf36d-8cb2-40c6-831f-80ef7488cca4.png" type="image/x-icon">
  <link rel="stylesheet" href="/css/toc.css">
  
  <!-- MathJax Configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        packages: ['base', 'ams', 'noerrors', 'noundefined']
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      startup: {
        ready() {
          MathJax.startup.defaultReady();
          // Re-render math when content changes
          document.addEventListener('DOMContentLoaded', function() {
            if (window.MathJax && window.MathJax.typesetPromise) {
              window.MathJax.typesetPromise();
            }
          });
        }
      }
    };
  </script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <header>
    <nav>
      <div class="nav-container">
        <div class="logo"><a href="/">Shark Blog</a></div>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="Search...">
          <div id="search-results"></div>
        </div>
        <div class="menu-toggle">
          <i class="fas fa-bars"></i>
        </div>
      </div>
      <ul class="nav-links">
        <li><a href="/">Posts</a></li>
        <li><a href="/services">Services</a></li>
        <li><a href="/archives">Archive</a></li>
        <li><a href="/categories">Categories</a></li>
        <li><a href="/about">About</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="page-container">
  
    <div class="toc-card">
      <div class="toc-content">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-text">èƒŒæ™¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC"><span class="toc-text">è„šæœ¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#feedparser-%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">feedparser çš„ç”¨æ³•</span></a></li></ol>
      </div>
    </div>
  
  
  <article class="page-content">
    <h1 class="page-title">Lowendtalk_rssç›‘å¬storage_vps_offer</h1>
    <div class="page-body">
      <h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>æœ€è¿‘å¼€å§‹ç©ptï¼Œæƒ³è¦çœ‹çœ‹æœ‰æ²¡æœ‰åˆé€‚åˆä¾¿å®œçš„storage vpsï¼Œæ‰€ä»¥é€šè¿‡chat-gptå†™äº†ä¸ªpythonè„šæœ¬å®ç°å¯¹äºLowendtalk offeræ¿å—çš„ç›‘å¬ã€‚é€»è¾‘å¤§è‡´æ˜¯é€šè¿‡<code>feedparser</code> è·å–rsså†…å®¹æ‰¾åˆ°å¤§äºæœ€æ™šæ—¶é—´çš„æ–‡ç« æ ‡é¢˜æŸ¥è¯¢æ˜¯å¦åŒ…å«storageï¼Œå°†rssä¸­çš„æœ€æ™šæ–‡ç« çš„æ—¶é—´è¿›è¡Œä¿å­˜ï¼Œå¦‚æœæœ‰åˆ™é€šè¿‡telegram api å®ç°æ¶ˆæ¯æ¨é€ã€‚</p>
<h3 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> feedparser
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timezone

<span class="token keyword">def</span> <span class="token function">notice</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    api_url <span class="token operator">=</span> <span class="token string">"api_url"</span>
    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"chat_id"</span><span class="token punctuation">:</span> <span class="token string">"-chat_id"</span><span class="token punctuation">,</span>
        <span class="token string">"text"</span><span class="token punctuation">:</span> text
    <span class="token punctuation">&#125;</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>api_url<span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> response

<span class="token keyword">def</span> <span class="token function">fetch_and_notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># URL of the RSS feed</span>
        rss_url <span class="token operator">=</span> <span class="token string">"https://lowendtalk.com/categories/offers/feed.rss"</span>

        <span class="token comment"># Parse the RSS feed</span>
        feed <span class="token operator">=</span> feedparser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>rss_url<span class="token punctuation">)</span>

        <span class="token comment"># Read the last published date from file</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/root/script/let_monitor/last_date.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
            last_date_str <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            last_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>last_date_str<span class="token punctuation">,</span> <span class="token string">'%a, %d %b %Y %H:%M:%S %z'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> last_date_str <span class="token keyword">else</span> datetime<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>tzinfo<span class="token operator">=</span>timezone<span class="token punctuation">.</span>utc<span class="token punctuation">)</span>

        <span class="token comment"># Initialize the latest date variable</span>
        latest_date <span class="token operator">=</span> last_date

        <span class="token comment"># Sort entries by publication date</span>
        entries <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>feed<span class="token punctuation">.</span>entries<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> e<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>e<span class="token punctuation">.</span>published<span class="token punctuation">,</span> <span class="token string">'%a, %d %b %Y %H:%M:%S %z'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        <span class="token comment"># Iterate over sorted entries and send notifications for new entries</span>
        <span class="token keyword">for</span> entry <span class="token keyword">in</span> entries<span class="token punctuation">:</span>
            entry_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>entry<span class="token punctuation">.</span>published<span class="token punctuation">,</span> <span class="token string">'%a, %d %b %Y %H:%M:%S %z'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> entry_date <span class="token operator">></span> last_date <span class="token keyword">and</span> <span class="token string">'storage'</span> <span class="token keyword">in</span> entry<span class="token punctuation">.</span>title<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                title <span class="token operator">=</span> entry<span class="token punctuation">.</span>title
                link <span class="token operator">=</span> entry<span class="token punctuation">.</span>link
                pub_date <span class="token operator">=</span> entry<span class="token punctuation">.</span>published

                <span class="token comment"># Format the message to send</span>
                message <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"#VPSOFFERğŸ‘‹ğŸ‘‹\nNew Post: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>title<span class="token punctuation">&#125;</span></span><span class="token string">\nLink: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>link<span class="token punctuation">&#125;</span></span><span class="token string">\nPublished on: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>pub_date<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>

                <span class="token comment"># Send the notification</span>
                response <span class="token operator">=</span> notice<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Notification sent for </span><span class="token interpolation"><span class="token punctuation">&#123;</span>title<span class="token punctuation">&#125;</span></span><span class="token string">, status code: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

                <span class="token comment"># Update the latest date</span>
                <span class="token keyword">if</span> entry_date <span class="token operator">></span> latest_date<span class="token punctuation">:</span>
                    latest_date <span class="token operator">=</span> entry_date

        <span class="token comment"># Save the latest date to file</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/root/script/let_monitor/last_date.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>latest_date<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%a, %d %b %Y %H:%M:%S %z'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        error_message <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"Error in fetch_and_notify: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
        notice<span class="token punctuation">(</span>error_message<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>error_message<span class="token punctuation">)</span>

<span class="token comment"># Call the function to start the process</span>
fetch_and_notify<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="feedparser-çš„ç”¨æ³•"><a href="#feedparser-çš„ç”¨æ³•" class="headerlink" title="feedparser çš„ç”¨æ³•"></a>feedparser çš„ç”¨æ³•</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> feedparser

<span class="token comment"># 1. ä» URL è·å– RSS/Atom è®¢é˜…å†…å®¹</span>
feed_url <span class="token operator">=</span> <span class="token string">"https://www.example.com/feed.xml"</span>  <span class="token comment"># æ›¿æ¢æˆå®é™…çš„ RSS/Atom è®¢é˜…é“¾æ¥</span>
feed <span class="token operator">=</span> feedparser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>feed_url<span class="token punctuation">)</span>

<span class="token comment"># 2. è®¿é—®è®¢é˜…å†…å®¹ä¿¡æ¯</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è®¢é˜…åç§°:"</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è®¢é˜…é“¾æ¥:"</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>link<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è®¢é˜…æè¿°:"</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>description<span class="token punctuation">)</span>

<span class="token comment"># 3. è®¿é—®è®¢é˜…å†…å®¹ä¸­çš„æ¡ç›®</span>
<span class="token keyword">for</span> entry <span class="token keyword">in</span> feed<span class="token punctuation">.</span>entries<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¡ç›®æ ‡é¢˜:"</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¡ç›®é“¾æ¥:"</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>link<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¡ç›®å‘å¸ƒæ—¶é—´:"</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>published<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¡ç›®æ‘˜è¦:"</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>summary<span class="token punctuation">)</span>
    <span class="token comment"># è®¿é—®å…¶ä»–æ¡ç›®ä¿¡æ¯ï¼Œä¾‹å¦‚ä½œè€…ï¼Œæ ‡ç­¾ï¼Œå†…å®¹ï¼Œç­‰</span>
    <span class="token comment"># ...</span>

<span class="token comment"># 4. è®¿é—®æ¡ç›®å†…å®¹</span>
<span class="token keyword">for</span> entry <span class="token keyword">in</span> feed<span class="token punctuation">.</span>entries<span class="token punctuation">:</span>
    <span class="token comment"># è®¿é—®å®Œæ•´çš„å†…å®¹ï¼Œå¦‚æœå¯ç”¨</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ¡ç›®å®Œæ•´å†…å®¹:"</span><span class="token punctuation">,</span> entry<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>

<span class="token comment"># 5. å¤„ç†é”™è¯¯</span>
<span class="token keyword">if</span> feed<span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"é”™è¯¯:"</span><span class="token punctuation">,</span> feed<span class="token punctuation">.</span>bozo_exception<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç¤ºä¾‹è§£é‡Š:</strong></p>
<ol>
<li><strong>è·å–è®¢é˜…å†…å®¹:</strong> ä½¿ç”¨ <code>feedparser.parse(feed_url)</code> å‡½æ•°è§£æ RSS&#x2F;Atom è®¢é˜…å†…å®¹ã€‚</li>
<li><strong>è®¿é—®è®¢é˜…ä¿¡æ¯:</strong>  å¯ä»¥ä½¿ç”¨ <code>feed.feed.title</code>ã€<code>feed.feed.link</code> å’Œ <code>feed.feed.description</code> è®¿é—®è®¢é˜…çš„æ ‡é¢˜ã€é“¾æ¥å’Œæè¿°ä¿¡æ¯ã€‚</li>
<li><strong>è®¿é—®æ¡ç›®:</strong> <code>feed.entries</code> åŒ…å«è®¢é˜…ä¸­çš„æ‰€æœ‰æ¡ç›®ï¼Œä½ å¯ä»¥éå†å®ƒä»¬å¹¶è®¿é—®æ¯ä¸ªæ¡ç›®çš„ä¿¡æ¯ã€‚</li>
<li><strong>è®¿é—®æ¡ç›®å†…å®¹:</strong> æ¯ä¸ªæ¡ç›®éƒ½åŒ…å« <code>title</code>ã€<code>link</code>ã€<code>published</code> å’Œ <code>summary</code> å±æ€§ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è®¿é—®å…¶ä»–å±æ€§ã€‚</li>
<li><strong>å¤„ç†é”™è¯¯:</strong>  <code>feed.status</code> è¡¨ç¤º HTTP çŠ¶æ€ç ï¼Œ<code>feed.bozo_exception</code> è¡¨ç¤ºè§£æé”™è¯¯ä¿¡æ¯ã€‚</li>
</ol>
<p><strong>å…¶ä»–å¸¸ç”¨ç”¨æ³•:</strong></p>
<ul>
<li><strong>æŒ‡å®šè§£æå™¨:</strong>  å¯ä»¥ä½¿ç”¨ <code>feedparser.parse(feed_url, handlers=&#123;&#125;)</code>, å…¶ä¸­ <code>handlers</code> æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œç”¨äºæŒ‡å®šè‡ªå®šä¹‰è§£æå™¨ã€‚</li>
<li><strong>ä½¿ç”¨ç¼“å­˜:</strong> ä½¿ç”¨ <code>feedparser.parse(feed_url, cache=True)</code> å¯ä»¥å°†è®¢é˜…å†…å®¹ç¼“å­˜èµ·æ¥ï¼Œé¿å…é‡å¤è§£æã€‚</li>
<li><strong>å¤„ç†å›¾ç‰‡:</strong>  æŸäº› RSS&#x2F;Atom è®¢é˜…åŒ…å«å›¾ç‰‡ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>entry.media_content</code> è®¿é—®å®ƒä»¬ã€‚</li>
<li><strong>å¤„ç†è‡ªå®šä¹‰å­—æ®µ:</strong> ä¸åŒè®¢é˜…å¯èƒ½æœ‰ä¸åŒçš„è‡ªå®šä¹‰å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ <code>entry.keys()</code> æŸ¥çœ‹å¯ç”¨å­—æ®µï¼Œå¹¶æ ¹æ®éœ€è¦è®¿é—®å®ƒä»¬ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹ä»£ç ä¸­çš„æ³¨é‡Šéƒ¨åˆ†åŒ…å«æ›´å¤šç¤ºä¾‹ç”¨æ³•ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</strong></p>

    </div>
  </article>
</div>
  </main>

  <footer>
    <p>
      &copy; 2025 Shark Blog 
      <a href="https://github.com/eddiehex/hexo-geek-source" target="_blank">
        <i class="fab fa-github"></i>
      </a>
    </p>
  </footer>

  <script src="/js/search.js"></script>
  <script src="/js/main.js"></script>
  <script src="/js/copy-code.js"></script>
  <script src="/js/prism.js"></script>
  <script src="/js/toc-highlight.js"></script>
  <script src="/js/mobile-menu.js"></script>
</body>
</html>
